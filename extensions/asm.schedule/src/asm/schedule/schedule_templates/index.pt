<span tal:replace="structure context/message|nothing" />

<p class="scheduleclasses">
<tal:block repeat="option view/filter/detail_options">
  <a tal:attributes="href string:?details=${option/token}&day=${view/filter/day};
                     class option/class_"
     tal:content="option/label">major events only</a>
</tal:block>
</p>

<p class="scheduledays">
<tal:block repeat="option view/filter/day_options">
<span tal:attributes="class option/class_">
<a tal:attributes="href string:?day=${option/token}&details=${view/filter/details}"
     tal:content="option/label">Thursday</a>
</span>
</tal:block>
</p>



  <table class="schedule">
    <tal:block repeat="record view/filter/events">
    <tr class="day">
      <th colspan="2" tal:content="python:record['day'].strftime('%A')">
      </th>
    </tr>
    <tal:block repeat="hour_record record/hours">
    <tal:block repeat="event hour_record/events">
    <tr>
      <th tal:condition="repeat/event/start"
        tal:content="python:hour_record['hour'].strftime('%H:%M')"
        tal:attributes="rowspan repeat/event/length">
      </th>
      <td tal:attributes="class python:view.event_class(event['event'])">
        <span class="disclose" tal:condition="event/event/description">&nbsp;</span>
        <a tal:content="event/event/title" tal:attributes="name event/key; href python:event['event'].url or None "></a>
        <br/>
        <tal:block tal:condition="event/event/location">
          <a tal:content="event/event/location" tal:attributes="href event/event/location_url" class="location"></a>
        </tal:block>
        <span class="until" tal:condition="python:event['event'].start != event['event'].end">&ndash;
          until <span tal:content="python:event['event'].end.strftime('%H:%M')">12:00</span>
          <span tal:condition="python:event['event'].start.day != event['event'].end.day" tal:content="python:event['event'].end.strftime('%A')"/>
        </span>
        <p class="cancelled" tal:condition="event/event/canceled">Unfortunately, this event has been cancelled. :(</p>

        <div class="description" tal:condition="event/event/description" tal:content="structure event/event/description">
        </div>
      </td>
    </tr>
    </tal:block>
    </tal:block>
    </tal:block>
  </table>

<script type="text/javascript">
  $(document).ready(function() {
      $('table.schedule td').click(function() {
        $('.description', this).slideToggle();
        $('.disclose', this).toggleClass('opened');
        });
      $('table.schedule td').hover(
        function(){ $('.disclose', this).addClass('hover'); },
        function(){ $('.disclose', this).removeClass('hover');});
  });
</script>
